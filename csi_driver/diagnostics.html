<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Hewlett Packard Enterprise" /><link rel="canonical" href="https://scod.hpedev.io/csi_driver/diagnostics.html" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="HPE Storage Container Orchestrator Documentation (SCOD)"/>
    <meta property="og:description" content="This is an umbrella documentation project for all container integrations surrounding HPE block, file and object storage. Tailored for IT ops, developers and technology partners."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://scod.hpedev.io"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://scod.hpedev.io/img/hpe-social-og-image01.png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    
    <title>Diagnostics - SCOD.HPEDEV.IO</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/hpedev.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Diagnostics";
        var mkdocs_page_input_path = "csi_driver/diagnostics.md";
        var mkdocs_page_url = "/csi_driver/diagnostics.html";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-PC28RTKKTW"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', "G-PC28RTKKTW");
      </script>
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../img/hpe.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">HPE CSI DRIVER FOR KUBERNETES</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="using.html">Using</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Container Storage Providers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="container_storage_provider/hpe_alletra_storage_mp_b10000/index.html">HPE Alletra Storage MP B10000, Alletra 9000, Primera and 3PAR</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="container_storage_provider/hpe_alletra_storage_mp_b10000_file_service/index.html">HPE Alletra Storage MP B10000 File Service</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="container_storage_provider/hpe_alletra_6000/index.html">HPE Alletra 5000/6000 and Nimble Storage</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="monitor.html">Pod Monitor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="operations.html">Auxiliary Operations</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Diagnostics</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#sanity_checks">Sanity Checks</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#nfs_server_provisioner_resources">NFS Server Provisioner Resources</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#tracing_nfs_resources">Tracing NFS resources</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#volume_and_snapshot_groups">Volume and Snapshot Groups</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#logging">Logging</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#csi_driver_logs">CSI Driver Logs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#log_level">Log Level</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#csp_logs">CSP Logs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#log_collector">Log Collector</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#tuning">Tuning</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#data_path_configuration">Data Path Configuration</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Partner Ecosystems</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="partners/hpe_morpheus/install.html">HPE Morpheus Kubernetes Service</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/hpe_ezmeral/install.html">HPE Ezmeral Runtime Enterprise</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/amazon_eks_anywhere/index.html">Amazon EKS Anywhere</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/canonical/index.html">Canonical</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/cohesity/index.html">Cohesity</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/commvault/index.html">Commvault</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/kasten/index.html">Veeam Kasten</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/mirantis/index.html">Mirantis</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/redhat_openshift/index.html">Red Hat OpenShift</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/suse_virtualization/index.html">SUSE Virtualization</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/suse_rancher/index.html">SUSE Rancher</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/tkgi/index.html">Tanzu TKGI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="partners/vmware/index.html">VMware</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">HPE COSI DRIVER FOR KUBERNETES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../cosi_driver/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cosi_driver/deployment.html">Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cosi_driver/using.html">Using</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cosi_driver/diagnostics.html">Diagnostics</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">HPE GREENLAKE FOR FILE STORAGE</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../filex_csi_driver/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../filex_csi_driver/deployment.html">Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../filex_csi_driver/using.html">Using</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEARN</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../learn/persistent_storage/index.html">Persistent Storage for Kubernetes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../learn/introduction_to_containers/index.html">For HPE partners:<br />&nbsp;&nbsp; Introduction to Containers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../learn/csi_primitives/index.html">Introduction to CSI Primitives</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../learn/video_gallery/index.html">Video Gallery</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../learn/csi_workshop/index.html">Interactive CSI Workshop</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">COMMUNITY</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://developer.hpe.com">HPE Developer</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://slack.hpedev.io">Sign up to HPE Developer on Slack</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/hpe-storage/scod/issues/new?title=I have some feedback on SCOD">Got feedback?</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">EXTERNAL LINKS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://github.com/hpe-storage/scod">SCOD on GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/hpe-storage">HPE Storage on GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://hpe.com/storage/containers">Storage for Containers on hpe.com</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/support/index.html">Support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/notices/index.html">Notices</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGACY DRIVERS AND PLUGINS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legacy/index.html">Docker, FlexVolume and CSPs</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">SCOD.HPEDEV.IO</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">HPE CSI DRIVER FOR KUBERNETES</li>
      <li class="breadcrumb-item active">Diagnostics</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h1>
<p>It's recommended to familiarize yourself with inspecting workloads on Kubernetes. This particular <a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/#interacting-with-running-pods">cheat sheet</a> is very useful to have readily available. </p>
<h2 id="sanity_checks">Sanity Checks<a class="headerlink" href="#sanity_checks" title="Permanent link">&para;</a></h2>
<p>Once the CSI driver has been deployed either through object configuration files, Helm or an Operator. This view should be representative of what a healthy system should look like after install. If any of the workload deployments lists anything but <code>Running</code>, proceed to inspect the logs of the problematic workload.</p>
<div class=md-fenced-code-tabs id=tab-tab-group-0><input name=tab-group-0 type=radio id=tab-group-0-0_text checked=checked class=code-tab data-lang=text aria-controls=tab-group-0-0_text-panel role=tab><label for=tab-group-0-0_text class=code-tab-label data-lang=text id=tab-group-0-0_text-label>HPE Alletra 5000/6000 and Nimble Storage</label><div class=code-tabpanel role=tabpanel data-lang=text id=tab-group-0-0_text-panel aria-labelledby=tab-group-0-0_text-label><pre><code class=text>kubectl get pods --all-namespaces -l 'app in (nimble-csp, hpe-csi-node, hpe-csi-controller)'
NAMESPACE     NAME                                  READY   STATUS    RESTARTS   AGE
hpe-storage   hpe-csi-controller-7d9cd6b855-zzmd9   9/9     Running   0          15s
hpe-storage   hpe-csi-node-dk5t4                    2/2     Running   0          15s
hpe-storage   hpe-csi-node-pwq2d                    2/2     Running   0          15s
hpe-storage   nimble-csp-546c9c4dd4-5lsdt           1/1     Running   0          15s
</code></pre></div><input name=tab-group-0 type=radio id=tab-group-0-1_text class=code-tab data-lang=text aria-controls=tab-group-0-1_text-panel role=tab><label for=tab-group-0-1_text class=code-tab-label data-lang=text id=tab-group-0-1_text-label>HPE Alletra Storage MP B10000, Alletra 9000, Primera and 3PAR</label><div class=code-tabpanel role=tabpanel data-lang=text id=tab-group-0-1_text-panel aria-labelledby=tab-group-0-1_text-label><pre><code class=text>kubectl get pods --all-namespaces -l 'app in (primera3par-csp, hpe-csi-node, hpe-csi-controller)'
NAMESPACE     NAME                                  READY   STATUS    RESTARTS   AGE
hpe-storage   hpe-csi-controller-7d9cd6b855-fqppd   9/9     Running   0          14s
hpe-storage   hpe-csi-node-86kh6                    2/2     Running   0          14s
hpe-storage   hpe-csi-node-k8p4p                    2/2     Running   0          14s
hpe-storage   hpe-csi-node-r2mg8                    2/2     Running   0          14s
hpe-storage   hpe-csi-node-vwb5r                    2/2     Running   0          14s
hpe-storage   primera3par-csp-546c9c4dd4-bcwc6      1/1     Running   0          14s
</code></pre></div></div>
<p>A Custom Resource Definition (CRD) named <code>hpenodeinfos.storage.hpe.com</code> holds important network and host initiator information. </p>
<p>Retrieve list of nodes.</p>
<p> <pre><code class=text>kubectl get hpenodeinfos
$ kubectl get hpenodeinfos
NAME               AGE
tme-lnx-worker1   57m
tme-lnx-worker3   57m
tme-lnx-worker2   57m
tme-lnx-worker4   57m
</code></pre></p>
<p>Inspect a node.</p>
<p> <pre><code class=yaml>kubectl get hpenodeinfos/tme-lnx-worker1 -o yaml
apiVersion: storage.hpe.com/v1
kind: HPENodeInfo
metadata:
  creationTimestamp: &quot;2020-08-24T23:50:09Z&quot;
  generation: 1
  managedFields:
  - apiVersion: storage.hpe.com/v1
    fieldsType: FieldsV1
    fieldsV1:
      f:spec:
        .: {}
        f:chap_password: {}
        f:chap_user: {}
        f:iqns: {}
        f:networks: {}
        f:uuid: {}
    manager: csi-driver
    operation: Update
    time: &quot;2020-08-24T23:50:09Z&quot;
  name: tme-lnx-worker1
  resourceVersion: &quot;30337986&quot;
  selfLink: /apis/storage.hpe.com/v1/hpenodeinfos/tme-lnx-worker1
  uid: 3984752b-29ac-48de-8ca0-8381532cbf06
spec:
  chap_password: RGlkIHlvdSByZWFsbHkgZGVjb2RlIHRoaXM/
  chap_user: chap-user
  iqns:
  - iqn.1994-05.com.redhat:828e7a4eef40
  networks:
  - 10.2.2.2/16
  - 172.16.6.115/24
  - 172.16.8.115/24
  - 172.17.0.1/16
  - 10.1.1.0/12
  uuid: 0242f811-3995-746d-652d-6c6e78352d77
</code></pre></p>
<h2 id="nfs_server_provisioner_resources">NFS Server Provisioner Resources<a class="headerlink" href="#nfs_server_provisioner_resources" title="Permanent link">&para;</a></h2>
<p>The NFS Server Provisioner consists of a number of Kubernetes resources per PVC. The default <code>Namespace</code> where the resources are deployed is "hpe-nfs" but is configurable in the <code>StorageClass</code>. See <a href="using.html#base_storageclass_parameters">base <code>StorageClass</code> parameters</a> for more details.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>ConfigMap</td>
<td>hpe-nfs-config</td>
<td>This <code>ConfigMap</code> holds the configuration file for the NFS server. Local tweaks may be wanted. Please see the <a href="https://github.com/nfs-ganesha/nfs-ganesha/tree/master/src/config_samples">config file reference</a> for more details.</td>
</tr>
<tr>
<td>Deployment</td>
<td>hpe-nfs-UID</td>
<td>The <code>Deployment</code> that is running the NFS <code>Pod</code>.</td>
</tr>
<tr>
<td>Service</td>
<td>hpe-nfs-UID</td>
<td>The <code>Service</code> the NFS clients perform mounts against.</td>
</tr>
<tr>
<td>PVC</td>
<td>hpe-nfs-UID</td>
<td>The RWO claim serving the NFS workload.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The UID stems from the user request RWX <code>PVC</code> for easy tracking. Use <code>kubectl get pvc/my-pvc -o jsonpath='{.metadata.uid}{"\n"}'</code> to retrieve it.</p>
</div>
<h3 id="tracing_nfs_resources">Tracing NFS resources<a class="headerlink" href="#tracing_nfs_resources" title="Permanent link">&para;</a></h3>
<p>When troubleshooting NFS deployments it's common that only the source RWX <code>PVC</code> and <code>Namespace</code> is known. The next few steps explains how resources can be easily traced.</p>
<p>Retrieve the "hpe-nfs-UID" from the NFS <code>Pod</code> by specifying <code>PVC</code> and <code>Namespace</code> of the RWX <code>PVC</code>:</p>
<p> <pre><code class=text>kubectl get pods -l provisioned-by=my-pvc,provisioned-from=my-namespace -A -o jsonpath='{.items[].metadata.labels.app}{&quot;\n&quot;}'
</code></pre></p>
<p>Next, enumerate the resources from the "hpe-nfs-UID":</p>
<p> <pre><code class=text>kubectl get pvc,svc,deploy -A -o name --field-selector metadata.name=hpe-nfs-UID
</code></pre></p>
<p>Example output:</p>
<p> <pre><code class=text>persistentvolumeclaim/hpe-nfs-UID
service/hpe-nfs-UID
deployment.apps/hpe-nfs-UID
</code></pre></p>
<p>If only the <code>PV</code> name is known, looking from the backend storage perspective, the <code>PV</code> name (and <code>.spec.claimRef.uid</code>) contains the UID, for example: "pvc-UID".</p>
<div class="admonition seealso">
<p class="admonition-title">Clarification</p>
<p>The <code>hpe-nfs-UID</code> is abbreviated, it will contain a real UID added on, for example "hpe-nfs-98ce7c80-13f9-45d0-9609-089227bf97f1".</p>
</div>
<h2 id="volume_and_snapshot_groups">Volume and Snapshot Groups<a class="headerlink" href="#volume_and_snapshot_groups" title="Permanent link">&para;</a></h2>
<p>If there's issues with <code>VolumeSnapshots</code> not being created when performing <code>SnapshotGroup</code> snapshots, checking the logs of the "csi-volume-group-provisioner" and "csi-volume-group-snapshotter" in the "hpe-csi-controller" <code>Deployment</code>.</p>
<p> <pre><code class=text>kubectl logs -n hpe-storage deploy/hpe-csi-controller csi-volume-group-provisioner
kubectl logs -n hpe-storage deploy/hpe-csi-controller csi-volume-group-snapshotter
</code></pre></p>
<h2 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">&para;</a></h2>
<p>Log files associated with the HPE CSI Driver logs data to the standard output stream. If the logs need to be retained for long term, use a standard logging solution for Kubernetes such as Fluentd. Some of the logs on the host are persisted which follow standard logrotate policies.</p>
<h3 id="csi_driver_logs">CSI Driver Logs<a class="headerlink" href="#csi_driver_logs" title="Permanent link">&para;</a></h3>
<p>Node driver:</p>
<p> <pre><code class=text>kubectl logs -f  daemonset.apps/hpe-csi-node  hpe-csi-driver -n hpe-storage
</code></pre></p>
<p>Controller driver:</p>
<p> <pre><code class=text>kubectl logs -f deployment.apps/hpe-csi-controller hpe-csi-driver -n hpe-storage
</code></pre></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The logs for both node and controller drivers are persisted at <code>/var/log/hpe-csi.log</code></p>
</div>
<h3 id="log_level">Log Level<a class="headerlink" href="#log_level" title="Permanent link">&para;</a></h3>
<p>Log levels for both CSI Controller and Node driver can be controlled using <code>LOG_LEVEL</code> environment variable. Possible values are <code>info</code>, <code>warn</code>, <code>error</code>, <code>debug</code>, and <code>trace</code>. Apply the changes using <code>kubectl apply -f &lt;yaml&gt;</code> command after adding this to CSI controller and node container spec as below. For Helm charts this is controlled through <code>logLevel</code> variable in <code>values.yaml</code>.</p>
<p> <pre><code class=text>          env:
            - name: LOG_LEVEL
              value: trace
</code></pre></p>
<h3 id="csp_logs">CSP Logs<a class="headerlink" href="#csp_logs" title="Permanent link">&para;</a></h3>
<p>CSP logs can be accessed from their respective services.</p>
<div class=md-fenced-code-tabs id=tab-tab-group-10><input name=tab-group-10 type=radio id=tab-group-10-0_text checked=checked class=code-tab data-lang=text aria-controls=tab-group-10-0_text-panel role=tab><label for=tab-group-10-0_text class=code-tab-label data-lang=text id=tab-group-10-0_text-label>HPE Alletra 5000/6000 and Nimble Storage</label><div class=code-tabpanel role=tabpanel data-lang=text id=tab-group-10-0_text-panel aria-labelledby=tab-group-10-0_text-label><pre><code class=text>kubectl logs -f deploy/nimble-csp -n hpe-storage
</code></pre></div><input name=tab-group-10 type=radio id=tab-group-10-1_text class=code-tab data-lang=text aria-controls=tab-group-10-1_text-panel role=tab><label for=tab-group-10-1_text class=code-tab-label data-lang=text id=tab-group-10-1_text-label>HPE Alletra Storage MP B10000, Alletra 9000, Primera and 3PAR</label><div class=code-tabpanel role=tabpanel data-lang=text id=tab-group-10-1_text-panel aria-labelledby=tab-group-10-1_text-label><pre><code class=text>kubectl logs -f deploy/primera3par-csp -n hpe-storage
</code></pre></div></div>
<h3 id="log_collector">Log Collector<a class="headerlink" href="#log_collector" title="Permanent link">&para;</a></h3>
<p>Log collector script <code>hpe-logcollector.sh</code> can be used to collect the logs from any node which has <code>kubectl</code> access to the cluster.</p>
<p> <pre><code class=text>curl -O https://raw.githubusercontent.com/hpe-storage/csi-driver/master/hpe-logcollector.sh
chmod 555 hpe-logcollector.sh
</code></pre></p>
<p>Usage:</p>
<p> <pre><code class=text>./hpe-logcollector.sh -h
Collect HPE storage diagnostic logs using kubectl.

Usage:
     hpe-logcollector.sh [-h|--help] [--node-name NODE_NAME] \
                         [-n|--namespace NAMESPACE] [-a|--all]
Options:
-h|--help                  Print this usage text
--node-name NODE_NAME      Collect logs only for Kubernetes node
                           NODE_NAME
-n|--namespace NAMESPACE   Collect logs from HPE CSI deployment in namespace
                           NAMESPACE (default: kube-system)
-a|--all                   Collect logs from all nodes (the default)
</code></pre></p>
<h2 id="tuning">Tuning<a class="headerlink" href="#tuning" title="Permanent link">&para;</a></h2>
<p>HPE provides a set of well tested defaults for the CSI driver and all the supported CSPs. In certain case it may be necessary to fine tune the CSI driver to accommodate a certain workload or behavior. </p>
<h3 id="data_path_configuration">Data Path Configuration<a class="headerlink" href="#data_path_configuration" title="Permanent link">&para;</a></h3>
<p>The HPE CSI Driver for Kubernetes automatically configures Linux iSCSI/multipath settings based on <a href="https://raw.githubusercontent.com/hpe-storage/co-deployments/master/helm/charts/hpe-csi-driver/files/config.json">config.json</a>. In order to tune these values, edit the config map with <code>kubectl edit configmap hpe-linux-config -n hpe-storage</code> and restart node plugin using <code>kubectl delete pod -l app=hpe-csi-node</code> to apply.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>HPE provide a set of general purpose default values for the IO paths, tuning is only required if prescribed by HPE.</p>
</div>
              
            </div>
          </div>

<footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2020-2025 Hewlett Packard Enterprise Development LP<br />Give <a href="https://github.com/hpe-storage/scod/issues/new?title=csi_driver/diagnostics.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/hpe-storage/scod" class="fa fa-code-fork" style="color: #fcfcfc"> hpe-storage/scod</a>
        </span>
    
    
      <span><a href="operations.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="partners/hpe_morpheus/install.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
