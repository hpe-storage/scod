<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Hewlett Packard Enterprise" /><link rel="canonical" href="https://scod.hpedev.io/cosi_driver/diagnostics.html" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <meta property="og:title" content="HPE Storage Container Orchestrator Documentation (SCOD)"/>
    <meta property="og:description" content="This is an umbrella documentation project for all container integrations surrounding HPE block, file and object storage. Tailored for IT ops, developers and technology partners."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://scod.hpedev.io"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://scod.hpedev.io/img/hpe-social-og-image01.png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    
    <title>Diagnostics - SCOD.HPEDEV.IO</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/hpedev.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Diagnostics";
        var mkdocs_page_input_path = "cosi_driver/diagnostics.md";
        var mkdocs_page_url = "/cosi_driver/diagnostics.html";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-PC28RTKKTW"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', "G-PC28RTKKTW");
      </script>
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../img/hpe.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">WELCOME</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../welcome/index.html">Get started!</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">HPE CSI DRIVER FOR KUBERNETES</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../csi_driver/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../csi_driver/deployment.html">Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../csi_driver/using.html">Using</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Container Storage Providers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/container_storage_provider/hpe_alletra_storage_mp_b10000/index.html">HPE Alletra Storage MP B10000, Alletra 9000, Primera and 3PAR</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/container_storage_provider/hpe_alletra_storage_mp_b10000_file_service/index.html">HPE Alletra Storage MP B10000 File Service</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/container_storage_provider/hpe_alletra_6000/index.html">HPE Alletra 5000/6000 and Nimble Storage</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../csi_driver/metrics.html">Metrics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../csi_driver/monitor.html">Pod Monitor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../csi_driver/operations.html">Auxiliary Operations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../csi_driver/diagnostics.html">Diagnostics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Partner Ecosystems</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/hpe_morpheus/install.html">HPE Morpheus Kubernetes Service</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/hpe_ezmeral/install.html">HPE Ezmeral Runtime Enterprise</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/amazon_eks_anywhere/index.html">Amazon EKS Anywhere</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/canonical/index.html">Canonical</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/cohesity/index.html">Cohesity</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/commvault/index.html">Commvault</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/kasten/index.html">Veeam Kasten</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/mirantis/index.html">Mirantis</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/redhat_openshift/index.html">Red Hat OpenShift</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/suse_virtualization/index.html">SUSE Virtualization</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/suse_rancher/index.html">SUSE Rancher</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/tkgi/index.html">Tanzu TKGI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../csi_driver/partners/vmware/index.html">VMware</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">HPE COSI DRIVER FOR KUBERNETES</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="using.html">Using</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Diagnostics</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#sanity_checks">Sanity Checks</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#logging">Logging</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cosi_driver_logs">COSI Driver Logs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cosi_sidecar_logs">COSI Sidecar Logs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cosi_controller_logs">COSI Controller Logs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#log_level_of_sidecar">Log Level of Sidecar</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#log_collector">Log Collector</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">HPE GREENLAKE FOR FILE STORAGE</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../filex_csi_driver/index.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../filex_csi_driver/deployment.html">Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../filex_csi_driver/using.html">Using</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEARN</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../learn/persistent_storage/index.html">Persistent Storage for Kubernetes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../learn/introduction_to_containers/index.html">For HPE partners:<br />&nbsp;&nbsp; Introduction to Containers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../learn/csi_primitives/index.html">Introduction to CSI Primitives</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../learn/video_gallery/index.html">Video Gallery</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../learn/csi_workshop/index.html">Interactive CSI Workshop</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">COMMUNITY</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://developer.hpe.com">HPE Developer</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://slack.hpedev.io">Sign up to HPE Developer on Slack</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/hpe-storage/scod/issues/new?title=I have some feedback on SCOD">Got feedback?</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">EXTERNAL LINKS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://github.com/hpe-storage/scod">SCOD on GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/hpe-storage">HPE Storage on GitHub</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://hpe.com/storage/containers">Storage for Containers on hpe.com</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGAL</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/contributing/index.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/support/index.html">Support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/license/index.html">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../legal/notices/index.html">Notices</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LEGACY DRIVERS AND PLUGINS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../legacy/index.html">Docker, FlexVolume and CSPs</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">SCOD.HPEDEV.IO</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">HPE COSI DRIVER FOR KUBERNETES</li>
      <li class="breadcrumb-item active">Diagnostics</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h1>
<p>It's recommended to familiarize yourself with inspecting workloads on Kubernetes. This <a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/#interacting-with-running-pods">cheat sheet</a> is very useful, and you should have it readily available.</p>
<h2 id="sanity_checks">Sanity Checks<a class="headerlink" href="#sanity_checks" title="Permanent link">&para;</a></h2>
<p>Once the COSI driver has been deployed using Helm, the list of pods shown below is representative of what a healthy system would look like after installation. If any of the workload deployments lists anything but <code>Running</code>, proceed to inspect the logs for the problematic workload.</p>
<p> <pre><code class=text>kubectl get pods
NAME                                             READY   STATUS    RESTARTS   AGE
hpe-cosi-provisioner-559b458788-5jc56            2/2     Running   0          8d
objectstorage-controller-7dff56f8fc-r5tdq        1/1     Running   0          8d
</code></pre></p>
<p>Once the COSI API objects <code>BucketClaim</code>, <code>Bucket</code> and <code>BucketAccess</code> have been created in the cluster, use the <code>kubectl describe</code> command to check the status and events, which will have information useful to help diagnose any issue. If any of the resources' statuses shows anything but <code>true</code> or if there are any warning events, inspect the logs of the COSI driver and sidecar.</p>
<p>Describing a <code>BucketClaim</code>.</p>
<p> <pre><code class=text>kubectl describe bucketclaim my-first-bucketclaim
Name:         my-first-bucketclaim
Namespace:    default
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;
API Version:  objectstorage.k8s.io/v1alpha1
Kind:         BucketClaim
Metadata:
  Creation Timestamp:  2024-09-17T04:34:55Z
  Finalizers:
    cosi.objectstorage.k8s.io/bucketclaim-protection
  Generation:        1
  Resource Version:  110670
  UID:               99dde004-4f8d-4a20-900b-e5d61e3facb9
Spec:
  Bucket Class Name:  hpe-standard-object
  Protocols:
    s3
Status:
  Bucket Name:   bc199dde004-4f8d-4a20-900b-e5d61e3facb9
  Bucket Ready:  true
Events:          &lt;none&gt;
</code></pre></p>
<p>Describing a <code>Bucket</code>.</p>
<p> <pre><code class=text>kubectl describe bucket bc199dde004-4f8d-4a20-900b-e5d61e3facb9
Name:         bc199dde004-4f8d-4a20-900b-e5d61e3facb9
Namespace:
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;
API Version:  objectstorage.k8s.io/v1alpha1
Kind:         Bucket
Metadata:
  Creation Timestamp:  2024-09-17T04:34:55Z
  Finalizers:
    cosi.objectstorage.k8s.io/bucket-protection
    cosi.objectstorage.k8s.io/bucketaccess-bucket-protection
  Generation:        1
  Resource Version:  111014
  UID:               e7fb69f6-c20e-4abf-a522-f1ae765b3b6a
Spec:
  Bucket Claim:
    Name:             my-first-bucketclaim
    Namespace:        default
    UID:              99dde004-4f8d-4a20-900b-e5d61e3facb9
  Bucket Class Name:  hpe-standard-object
  Deletion Policy:    Delete
  Driver Name:        cosi.hpe.com
  Parameters:
    Bucket Tags:                 mytag=myvalue, mytag2=, mytag3=myvalue3,
    Cosi User Secret Name:       hpe-object-backend
    Cosi User Secret Namespace:  default
  Protocols:
    s3
Status:
  Bucket ID:     bc199dde004-4f8d-4a20-900b-e5d61e3facb9
  Bucket Ready:  true
Events:          &lt;none&gt;
</code></pre></p>
<p>Describing a <code>BucketAccess</code>.</p>
<p> <pre><code class=text>kubectl describe bucketaccess hpe-standard-access
Name:         hpe-standard-access
Namespace:    default
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;
API Version:  objectstorage.k8s.io/v1alpha1
Kind:         BucketAccess
Metadata:
  Creation Timestamp:  2024-09-17T04:38:00Z
  Finalizers:
    cosi.objectstorage.k8s.io/bucketaccess-protection
  Generation:        1
  Resource Version:  111017
  UID:               37fd517f-27ac-45fa-b369-57e645967366
Spec:
  Bucket Access Class Name:  hpe-standard-access
  Bucket Claim Name:         my-first-bucket-claim
  Credentials Secret Name:   my-first-access-secret
  Protocol:                  s3
Status:
  Access Granted:  true
  Account ID:      ba-37fd517f-27ac-45fa-b369-57e645967366
Events:            &lt;none&gt;
</code></pre></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is useful to check that the network connection between the Kubernetes cluster hosting the HPE COSI driver and HPE Data Services Cloud Console, as well as between the HPE Alletra Storage MP X 10000 system and HPE Data Services Cloud Console is intact. A poor network connection is a common cause of failure while creating or deleting <code>Bucket</code> and <code>BucketAccess</code> resources.</p>
</div>
<h2 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">&para;</a></h2>
<p>Log files associated with the HPE COSI Driver posts data to the standard output stream and can be accessed using options under <a href="https://kubernetes.io/docs/reference/kubectl/generated/kubectl_logs/">kubectl logs</a>.</p>
<p>If the logs need to be retained for long term, use a standard logging solution for Kubernetes, such as Fluentd. Alternatively, it's advised to use the log collector script, at regular intervals to preserve logs.</p>
<h3 id="cosi_driver_logs">COSI Driver Logs<a class="headerlink" href="#cosi_driver_logs" title="Permanent link">&para;</a></h3>
<p> <pre><code class=text>kubectl logs -f deploy/hpe-objectstorage-provisioner -c hpe-cosi-driver
</code></pre></p>
<h3 id="cosi_sidecar_logs">COSI Sidecar Logs<a class="headerlink" href="#cosi_sidecar_logs" title="Permanent link">&para;</a></h3>
<p> <pre><code class=text>kubectl logs -f deploy/hpe-objectstorage-provisioner -c hpe-cosi-provisioner-sidecar
</code></pre></p>
<h3 id="cosi_controller_logs">COSI Controller Logs<a class="headerlink" href="#cosi_controller_logs" title="Permanent link">&para;</a></h3>
<p> <pre><code class=text>kubectl logs -f deploy/objectstorage-controller
</code></pre></p>
<h3 id="log_level_of_sidecar">Log Level of Sidecar<a class="headerlink" href="#log_level_of_sidecar" title="Permanent link">&para;</a></h3>
<p>You can control the log level for the COSI Sidecar using the <code>.containers.sideCar.verbosityLevel</code> field in <a href="https://github.com/hpe-storage/co-deployments/blob/master/helm/values/cosi-driver/v1.0.0/values.yaml"><code>values.yaml</code></a> of the Helm chart. The values are generally small positive integers.</p>
<p> <pre><code class=yaml>containers:
  sideCar:
    # Verbosity level: Small postive integer values are generally recommended.
    # Ref.: https://pkg.go.dev/k8s.io/klog/v2#V
    # containers.sideCar.verbosityLevel -- Specifies the verbosity of the logs that will be printed by the sidecar container
    verbosityLevel: 5
</code></pre></p>
<h3 id="log_collector">Log Collector<a class="headerlink" href="#log_collector" title="Permanent link">&para;</a></h3>
<p>The log collector script <code>hpe-logcollector.sh</code> can be used to collect the logs from any node that has <code>kubectl</code> access to the cluster. Please see the script's associated <a href="https://github.com/hpe-storage/cosi-driver/tree/main/scripts/log_collection">documentation</a> for more details on usage and troubleshooting.</p>
<p>Download the script and provide execute permissions:</p>
<p> <pre><code class=text>wget https://raw.githubusercontent.com/hpe-storage/cosi-driver/main/scripts/log_collection/hpe-logcollector.sh
chmod +x hpe-logcollector.sh
</code></pre></p>
<p>Usage:</p>
<p> <pre><code class=text>./hpe-logcollector.sh -h
Collect HPE storage diagnostic logs using kubectl.

Usage:
     hpe-logcollector.sh [-h|--help] [-n|--namespace NAMESPACE]
Options:
-h|--help                  Print this usage text
-n|--namespace NAMESPACE   Collect logs from HPE COSI Driver Deployment in Namespace
                           NAMESPACE (default: default)
</code></pre></p>
              
            </div>
          </div>

<footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2020-2025 Hewlett Packard Enterprise Development LP<br />Give <a href="https://github.com/hpe-storage/scod/issues/new?title=cosi_driver/diagnostics.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/hpe-storage/scod" class="fa fa-code-fork" style="color: #fcfcfc"> hpe-storage/scod</a>
        </span>
    
    
      <span><a href="using.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../filex_csi_driver/index.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
